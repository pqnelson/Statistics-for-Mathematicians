\makeatletter
\usepackage{amsthm,amsmath,amssymb}
\usepackage{mathrsfs}
\usepackage[usenames,dvipsnames]{xcolor}
\usepackage{color}
\usepackage{fancyvrb}
\usepackage{listings}
\usepackage{marginnote}
\usepackage[inner=1in,textwidth=30pc,top=1in,marginparwidth=10pc,marginparsep=1.5pc]{geometry}
\usepackage[nottoc,numbib]{tocbibind}
\usepackage[12hr,us]{datetime}
\usepackage{titlesec}
\usepackage{ifpdf}
\usepackage[final]{graphicx}
\ifpdf
  \usepackage{microtype}
  \DeclareGraphicsRule{*}{mps}{*}{}
\fi
\usepackage[final,colorlinks=true, 
            hyperindex=true,
            citecolor=black,
            filecolor=black,
            menucolor=black,
            linkcolor=black,
            urlcolor=black,
            bookmarksopen=true,
            pdfauthor={Alex Nelson}]{hyperref}
\usepackage[all]{hypcap}

\def\homepage{\href{http://github.com/pqnelson/Statistics-for-Mathematicians/}{\texttt{github.com/pqnelson/Statistics-for-Mathematicians}}}
\author{Alex Nelson\footnote{This is a page from \homepage\hfil\break\indent\;\, Compiled:\enspace\today\ at \currenttime\ (PST)}\\\texttt{Email:\enspace\href{mailto:pqnelson@gmail.com}{pqnelson@gmail.com}}}


%% code highlighting
\definecolor{deepblue}{rgb}{0,0,0.5}
\definecolor{deepred}{rgb}{0.6,0,0}
\definecolor{deepgreen}{rgb}{0,0.5,0}
% Python style for highlighting
\newcommand\pythonstyle{\lstset{
language=Python,
basicstyle={\small\ttfamily},
otherkeywords={self},             % Add keywords here
keywordstyle={\sffamily\bfseries\color{deepblue}},
emph={MyClass,__init__},          % Custom highlighting
emphstyle={\sffamily\bfseries\color{deepred}},    % Custom highlighting style
stringstyle=\color{deepgreen},
frame=tb,                         % Any extra options here
showstringspaces=false            % 
}}


% Python environment
\lstnewenvironment{python}[1][]
{
\pythonstyle
\lstset{#1}
}
{}



\def\marginpar#1{\marginnote{\footnotesize\emph{#1}}}


\providecommand{\bysame}{\leavevmode\hbox to3em{\hrulefill}\thinspace}
% chunks
\@ifundefined{@addpunct}{
  \def\@addpunct#1{\ifnum\spacefactor>\@m \else#1\fi}
  }{}

\newcounter{M}[chapter]
\newcounter{MM}[M]
\renewcommand\theM{\arabic{chapter}.\arabic{M}}
\renewcommand\theMM{\theM.\arabic{MM}}

\def\M{\medbreak\noindent\refstepcounter{M}\textbf{\theM\@addpunct{.}\quad}\ignorespaces}
\def\N{\@ifstar
        \NStar%
        \NNoStar%
}
\def\NStar#1{\medbreak\noindent\textbf{#1\@addpunct{.}\quad}\ignorespaces}
\def\NNoStar#1{\M\textbf{#1\@addpunct{.}\quad}\ignorespaces}

\def\Mref#1{(\S\ref{#1})}
% definitions
\newcommand\define[1]{``\textbf{#1}''}

% theorems
\renewcommand{\thmhead}[3]{\thmname{#1}\thmnumber{ #2.\quad\ignorespaces}\thmnote{ (#3)}}
%\swapnumbers
\newtheoremstyle{mytheoremstyle} % name
    {\medskipamount}             % Space above
    {\medskipamount}              % Space below
    {\itshape}                   % Body font
    {}                           % Indent amount
    {\bfseries}                  % Theorem head font
    {.}                        % Punctuation after theorem head
    {1em}                        % Space after theorem head
    {\thmnumber{#2}.\quad\thmname{#1}\thmnote{ \normalfont{(#3)}}}
\newtheoremstyle{mydefnstyle}% name
    {\medskipamount}% Space above
    {\medskipamount}              % Space below
    {\normalfont}                   % Body font
    {}                           % Indent amount
    {\bfseries}                  % Theorem head font
    {.}                         % Punctuation after theorem head
    {1em}                        % Space after theorem head
    {\thmnumber{#2.\quad}\thmname{#1}\thmnote{ \normalfont{(#3)}}}  % Theorem head spec (can be left empty, meaning 'normal')
\newtheoremstyle{myrmkstyle}% name
    {\medskipamount}% Space above
    {\medskipamount}              % Space below
    {\normalfont}                   % Body font
    {}                           % Indent amount
    {\itshape}                  % Theorem head font
    {.}                         % Punctuation after theorem head
    {1em}                        % Space after theorem head
    {\thmnumber{#2}.\quad\thmname{#1}\thmnote{ \normalfont{(#3)}}}  % Theorem head spec (can be left empty, meaning 'normal')

\theoremstyle{mytheoremstyle}
\newtheorem{thm}[M]{Theorem}
\newtheorem{lemma}[M]{Lemma}
\newtheorem{cor}[MM]{Corollary}

\theoremstyle{mydefnstyle}%definition}
\newtheorem*{axiom}{Axiom}
\newtheorem{prop}[M]{Proposition}
\newtheorem{defn}[M]{Definition}
\newtheorem{ex}[M]{Example}

\theoremstyle{myrmkstyle}
\newtheorem{rmk}[MM]{Remark}

\numberwithin{equation}{chapter}

% exercise 
\font\manual=manfnt
\newcounter{xca}
\def\xca{\smallbreak\noindent\refstepcounter{xca}\llap{\manual x\hskip3pt}\textbf{Exercise \thexca.\enspace\relax}\ignorespaces}
\def\endxca{}

% section
\titleformat{\chapter}[display]
  {\large\sffamily} % format
  {\chaptertitlename\ \thechapter} % label
  {20pt} % sep
  {\filleft\Large\bfseries} % before
\def\sectionfont{\large\sffamily\bfseries}
\def\subsectionfont{\sffamily\bfseries}
\def\specialsection{\@startsection{section}{1}%
  \z@{.7\baselineskip\@plus\baselineskip}{.125\baselineskip}%
  {\sectionfont}}
\def\section{\@startsection{section}{1}%
  \z@{.7\baselineskip\@plus\baselineskip}{.125\baselineskip}%
  {\sectionfont}}
\def\subsection{\@startsection{subsection}{2}%
  \z@{.7\baselineskip\@plus\baselineskip}{.125\baselineskip}%
  {\subsectionfont}}
\def\subsubsection{\@startsection{subsubsection}{3}%
  \z@{.7\baselineskip\@plus\baselineskip}{.125\baselineskip}%
  {\subsectionfont}}



% arXiv links
\def\arXiv{\@ifnextchar[{\@arXivWith}{\@arXivWithout}}
\def\@arXivWith[#1]#2{\texttt{\href{http://arxiv.org/abs/#2}{arXiv:#2} [#1]}}
\def\@arXivWithout#1{\texttt{\href{http://arxiv.org/abs/#1}{arXiv:#1}}}

%% notation
\def\Pr{\mathop{\mathrm{Pr}}\nolimits}
\def\eqdef{\stackrel{\text{def}}{=}}
\newcommand\expected{\mathrm{E}}
\def\Var{\mathop{\mathrm{Var}}\nolimits}
\def\cov{\mathop{\mathrm{Cov}}\nolimits}

% sets
\newcommand\CC{\mathbb{C}}
\newcommand\NN{\mathbb{N}}
\newcommand\QQ{\mathbb{Q}}
\newcommand\RR{\mathbb{R}}
\newcommand\ZZ{\mathbb{Z}}
\newcommand\sampleSpace{\Omega}
\newcommand\comp[1]{{#1}^{\complement}}
\newcommand\powerset{\mathcal{P}}
\def\hom{\mathop{\mathrm{Hom}}\nolimits}
\let\propersubset\subset
\let\subset\subseteq
\let\propersupset\supset
\let\supset\supseteq

% calculus
\def\D{\mathrm{d}}
\def\E{\mathrm{e}}
\let\oldRe\Re
\def\Re{\mathop{\mathrm{Re}}\nolimits}
\def\bigO{\mathcal{O}}

% number theory
\def\intPart#1{\mathop{\texttt{[}}\nolimits\!#1\!\mathop{\texttt{]}}\nolimits}
\def\fracPart#1{\mathop{\{}\nolimits\!#1\!\mathop{\}}\nolimits}

% group theory
\newcommand\udot{\mathop{{}^{\textstyle .}}\nolimits}

% complex analysis
\newcommand\Res[2][z]{\mathop{\mathrm{Res}}\nolimits_{#1}#2}

% linear algebra
\let\<\langle
\let\>\rangle
\newcommand\End{\mathop{\mathrm{End}}\nolimits}
\newcommand\superb[2]{\ensuremath{[#1,#2\}}}
\def\Mat{\mathop{\mathrm{Mat}}\nolimits}
\def\normOrd#1{\mathop{:}\nolimits\!#1\!\mathop{:}\nolimits}

% bibliography
\let\newblock\newline

\makeatother
